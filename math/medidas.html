<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Medidas de Capacidade</title>
<link rel="stylesheet" href="../css/jogos.css"> 
<style>
  :root{
    --bg:#f7fbff;
    --card:#f51616;
    --accent:#2563eb;
    --ok:#16a34a;
    --err:#dc2626;
    --muted:#6b7280;
    --shadow: 0 6px 18px rgba(16,24,40,0.08);
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  }

  *{box-sizing:border-box}
  /* html,body{height:100%;margin:0;background:linear-gradient(180deg,#f0f8ff, #f7fbff);color:#0f172a} */
  .wrap{
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:28px;
  }

  .card{
    width:100%;
    max-width:880px;
    /* background:var(--corPainel); */
    /* border-radius:16px; */
    /* box-shadow:var(--shadow); */
    padding:22px;
    display:grid;
    gap:18px;
    grid-template-columns: 1fr 320px;
    /* backdrop-filter: blur(50px); */
    /* background-color: transparent;  */
  }

  /* responsive: single column on small screens */
  @media (max-width:880px){
    .card{grid-template-columns:1fr;}
  }

  header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:12px;
  }
  .title{
    font-size:1.25rem;
    font-weight:700;
    letter-spacing:-0.2px;
  }
  .subtitle{color:var(--muted); font-size:0.95rem}

  .main{
    padding:10px;
    display:flex;
    flex-direction:column;
    gap:14px;
    align-items:stretch;
    justify-content:center;
  }

  .product-box{
    background:linear-gradient(180deg,#fbfdff,#ffffff);
    border-radius:12px;
    padding:18px;
    display:flex;
    flex-direction:column;
    gap:8px;
    align-items:center;
    justify-content:center;
    border:1px solid rgba(15,23,42,0.03);
  }
  .product-name{
    font-size:1.55rem;
    font-weight:800;
    text-transform:capitalize;
  }
  .hint{color:var(--muted); font-size:0.95rem;}

  .options{
    display:flex;
    gap:12px;
    flex-wrap:wrap;
    justify-content:center;
    margin-top:6px;
  }

  button.option{
    min-width:110px;
    padding:12px 14px;
    border-radius:10px;
    border:2px solid rgba(37,99,235,0.08);
    background:#fff;
    font-weight:700;
    font-size:1rem;
    cursor:pointer;
    box-shadow: 0 4px 8px rgba(15,23,42,0.04);
    transition:transform .12s ease, box-shadow .12s ease, background .12s;
  }
  button.option:active{transform:translateY(2px)}
  button.option[aria-pressed="true"]{outline:4px solid rgba(37,99,235,0.08)}

  .sidebar{
    border-left:1px dashed rgba(15,23,42,0.04);
    padding-left:16px;
    display:flex;
    flex-direction:column;
    gap:12px;
  }
  @media (max-width:880px){ .sidebar{border-left:none;padding-left:0;} }

  .score{
    background:linear-gradient(180deg,#fff,#fbfdff);
    border-radius:10px;
    padding:12px;
    box-shadow: 0 6px 14px rgba(16,24,40,0.03);
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:10px;
  }
  .score strong{font-size:1.15rem}

  .controls{display:flex;gap:8px;flex-wrap:wrap}
  .btn{
    padding:10px 12px;
    border-radius:8px;
    border:0;
    background:var(--accent);
    color:white;
    font-weight:700;
    cursor:pointer;
  }
  .btn.ghost{background:transparent;color:var(--accent);border:2px solid rgba(37,99,235,0.12)}

  .feedback{
    min-height:38px;
    display:flex;align-items:center;gap:10px;
    font-weight:700;
  }
  .feedback.ok{color:var(--ok)}
  .feedback.err{color:var(--err)}

  .small{font-size:0.85rem;color:var(--muted)}

  footer.attribution{font-size:0.8rem;color:var(--muted);text-align:center;margin-top:6px}

  /* accessible focus */
  button:focus{outline:3px solid rgba(37,99,235,0.14);outline-offset:2px}
</style>
</head>
<body>
<div class="wrap">
  <div class="card painel" role="application" aria-label="Prática de medidas: quilo, metro e litro">
    <div class="main">
      <header>
        <div>
          <div class="title">Pratique medidas de capacidade</div>
          <!-- <div class="subtitle">Escolha entre <strong>quilo</strong>, <strong>metro</strong> e <strong>litro</strong></div> -->
        </div>
        <!-- <div class="small">Nível: <strong>Fácil</strong></div> -->
      </header>

      <div class="product-box" aria-live="polite">
        <div class="product-name" id="productName">carne</div>
        <!-- <div class="hint" id="productHint">Qual medida usamos normalmente para este produto?</div> -->
      </div>

      <div class="options" role="group" aria-label="Opções de medida">
        <button class="option" data-value="quilo" id="opt-quilo">quilo</button>
        <button class="option" data-value="metro" id="opt-metro">metro</button>
        <button class="option" data-value="litro" id="opt-litro">litro</button>
      </div>

      <div class="feedback small" id="feedbackArea" aria-live="assertive" role="status"></div>

      <div style="display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:center">
        <button class="btn" id="nextBtn">Próximo</button>
        <button class="btn ghost" id="shuffleBtn">Embaralhar lista</button>
        <!-- <button class="btn ghost" id="showAnswerBtn">Mostrar resposta</button> -->
      </div>

      <!-- <footer class="attribution">Dica: use as setas e Enter para escolher opções (acessível por teclado).</footer> -->
    </div>

    <aside class="sidebar" aria-hidden="false">
      <div class="score" title="Pontuação atual">
        <div>
          <div class="small">Pontuação</div>
          <strong id="score">0</strong>
        </div>
        <div>
          <div class="small">Tentativas</div>
          <strong id="tries">0</strong>
        </div>
      </div>

      <div style="display:grid;gap:8px">
        <div class="small"><strong>Último resultado:</strong></div>
        <div id="lastResult" class="small">—</div>
      </div>

      <div style="margin-top:auto">
        <div class="small"><strong>Lista de produtos</strong></div>
        <ul id="productList" class="small" style="padding-left:18px;margin-top:8px"></ul>
      </div>
    </aside>
  </div>
</div>

<script>
/*
  Lista de produtos e sua medida "correta".
  Observação: "quilo" = medida de massa (kg), "metro" = comprimento, "litro" = volume.
*/
const PRODUCTS = [
  {name: "arroz", answer: "quilo"},
  {name: "feijão", answer: "quilo"},
  {name: "açúcar", answer: "quilo"},
  {name: "carne", answer: "quilo"},
  {name: "banana", answer: "quilo"},
  {name: "leite", answer: "litro"},
  {name: "água mineral", answer: "litro"},
  {name: "suco", answer: "litro"},
  {name: "óleo de cozinha", answer: "litro"},
  {name: "corda", answer: "metro"},
  {name: "tecido", answer: "metro"},
  {name: "pano", answer: "metro"},
  {name: "gasolina", answer: "litro"},
  {name: "altura de uma pessoa", answer: "metro"},
  {name: "frango inteiro", answer: "quilo"}
];

// Elementos
const productNameEl = document.getElementById("productName");
const feedbackEl = document.getElementById("feedbackArea");
const scoreEl = document.getElementById("score");
const triesEl = document.getElementById("tries");
const lastResultEl = document.getElementById("lastResult");
const productListEl = document.getElementById("productList");

const options = Array.from(document.querySelectorAll("button.option"));
const nextBtn = document.getElementById("nextBtn");
const shuffleBtn = document.getElementById("shuffleBtn");
const showAnswerBtn = document.getElementById("showAnswerBtn");

let currentIndex = 0;
let order = [];
let score = 0;
let tries = 0;

// Initialize list and UI
function init(){
  order = [...Array(PRODUCTS.length).keys()];
  shuffle(order);
  currentIndex = 0;
  score = 0;
  tries = 0;
  updateScore();
  renderProductList();
  loadCurrent();
}
init();

// Render sidebar product list (names only)
function renderProductList(){
  productListEl.innerHTML = "";
  PRODUCTS.forEach((p, i)=> {
    const li = document.createElement("li");
    li.textContent = p.name;
    //  + " — " + p.answer;
    productListEl.appendChild(li);
  });
}

// Load current product
function loadCurrent(){
  const idx = order[currentIndex];
  const prod = PRODUCTS[idx];
  productNameEl.textContent = prod.name;
  feedbackEl.textContent = "";
  lastResultEl.textContent = "—";
  // reset buttons states
  options.forEach(b=>{
    b.disabled = false;
    b.setAttribute("aria-pressed","false");
    b.style.background = "";
    b.style.borderColor = "";
  });
}

// Handle choice
function handleChoice(choiceBtn){
  const chosen = choiceBtn.dataset.value;
  const idx = order[currentIndex];
  const correct = PRODUCTS[idx].answer;
  tries++;
  triesEl.textContent = tries;
  // disable all buttons to prevent repeat clicks
  options.forEach(b=>b.disabled = true);

  if(chosen === correct){
    score++;
    updateScore();
    feedbackEl.className = "feedback ok";
    feedbackEl.textContent = "✔️ Certo! " + correct.toUpperCase();
    lastResultEl.textContent = "Certo: " + PRODUCTS[idx].name;
    choiceBtn.style.background = "linear-gradient(180deg,#ECFDF5,#DCFCE7)";
    choiceBtn.style.borderColor = "rgba(22,163,74,0.14)";
    playTone('ok');
  } else {
    feedbackEl.className = "feedback err";
    feedbackEl.textContent = "✖ Errado. Resposta: " + correct;
    lastResultEl.textContent = "Errado: " + PRODUCTS[idx].name;
    choiceBtn.style.background = "linear-gradient(180deg,#FEF2F2,#FEE2E2)";
    choiceBtn.style.borderColor = "rgba(220,38,38,0.12)";
    // highlight correct button lightly
    const correctBtn = options.find(b => b.dataset.value === correct);
    if(correctBtn){
      correctBtn.style.background = "linear-gradient(180deg,#ECFDF5,#DCFCE7)";
      correctBtn.style.borderColor = "rgba(22,163,74,0.08)";
    }
    playTone('err');
  }
}

// Next item (wraps)
function nextItem(){
  currentIndex = (currentIndex + 1) % order.length;
  loadCurrent();
}

// Shuffle order
function shuffleOrder(){
  shuffle(order);
  currentIndex = 0;
  loadCurrent();
}

// Show answer for current
function showAnswer(){
  const idx = order[currentIndex];
  const correct = PRODUCTS[idx].answer;
  feedbackEl.className = "feedback";
  feedbackEl.textContent = "Resposta: " + correct;
  // visually mark correct
  options.forEach(b=>{
    if(b.dataset.value === correct){
      b.style.background = "linear-gradient(180deg,#ECFDF5,#DCFCE7)";
      b.style.borderColor = "rgba(22,163,74,0.14)";
    } else {
      b.style.background = "";
      b.style.borderColor = "";
    }
  });
}

// Utility: shuffle array in-place
function shuffle(array){
  for(let i=array.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [array[i],array[j]] = [array[j],array[i]];
  }
}

// Update score display
function updateScore(){
  scoreEl.textContent = score;
}

// Play simple tone for feedback using WebAudio
function playTone(kind){
  if(!window.AudioContext && !window.webkitAudioContext) return;
  const ctx = new (window.AudioContext || window.webkitAudioContext)();
  const o = ctx.createOscillator();
  const g = ctx.createGain();
  o.type = 'sine';
  if(kind === 'ok'){
    o.frequency.value = 880;
  } else {
    o.frequency.value = 220;
  }
  g.gain.value = 0.02;
  o.connect(g);
  g.connect(ctx.destination);
  o.start();
  setTimeout(()=>{ o.stop(); ctx.close(); }, 160);
}

// Event listeners
options.forEach(btn=>{
  btn.addEventListener('click', ()=> handleChoice(btn));
  // keyboard: Enter on focused option triggers click (native)
  btn.addEventListener('keydown', (e)=>{
    if(e.key === "Enter" || e.key === " "){
      e.preventDefault();
      btn.click();
    }
  });
});

// Next, shuffle, show answer
nextBtn.addEventListener('click', ()=> {
  nextItem();
});
shuffleBtn.addEventListener('click', ()=> {
  shuffleOrder();
});
showAnswerBtn.addEventListener('click', ()=> {
  showAnswer();
});

// keyboard navigation: left/right to cycle options, N for next
document.addEventListener('keydown', (e)=>{
  const key = e.key.toLowerCase();
  if(key === 'n'){ nextItem(); return; }
  // arrows to move focus among options
  const focusIndex = options.findIndex(b => b === document.activeElement);
  if(key === 'arrowright' || key === 'arrowdown'){
    e.preventDefault();
    const next = options[(focusIndex + 1 + options.length) % options.length];
    next.focus();
  } else if(key === 'arrowleft' || key === 'arrowup'){
    e.preventDefault();
    const prev = options[(focusIndex - 1 + options.length) % options.length];
    prev.focus();
  } else if(key === '1'){
    options[0].click();
  } else if(key === '2'){
    options[1].click();
  } else if(key === '3'){
    options[2].click();
  }
});

// Make the product list reflect current order (for teacher)
function updateProductListWithOrder(){
  productListEl.innerHTML = "";
  order.forEach(i=>{
    const li = document.createElement('li');
    li.textContent = PRODUCTS[i].name;
    productListEl.appendChild(li);
  });
}
updateProductListWithOrder();

// When shuffling, also update displayed list
shuffleBtn.addEventListener('click', updateProductListWithOrder);
</script>
</body>
</html>
